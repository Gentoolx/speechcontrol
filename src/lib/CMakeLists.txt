project(SpeechControlLibrary)
cmake_minimum_required(VERSION 2.8)

## variables
set(SPCHCNTRL_LIB_COMPILE_FLAGS "${SPCHCNTRL_COMPILE_FLAGS}")
set(SPCHCNTRL_LIB_COMPILE_DEFINITIONS "${SPCHCNTRL_COMPILE_DEFINITIONS}")
set(SPCHCNTRL_LIB_INCLUDE_DIR "${SPCHCNTRL_INCLUDE_DIR}/lib")
set(SPCHCNTRL_LIB_INCLUDE_DIRS "${SPCHNCTRL_INCLUDE_DIRS}"
    ${PYTHON_INCLUDE_DIRS}
    ${Boost_INCLUDE_DIRS})
set(SPCHCNTRL_LIB_LIBRARIES "${SPCHCNTRL_LIBRARIES}"
    ${Boost_LIBRARIES}
    ${PYTHON_LIBRARIES})
set(SPCHCNTRL_LIB_MAJOR_VERSION 0)
set(SPCHCNTRL_LIB_MINOR_VERSION 1)
set(SPCHCNTRL_LIB_VERSION "${SPCHCNTRL_LIB_MAJOR_VERSION}.${SPCHCNTRL_LIB_MINOR_VERSION}")

if(WITH_PYTHON_BINDINGS)
    message(STATUS "Python bindings for libspeechcontrol enabled.")
    find_package(PythonLibs 2.7)
    find_package(Boost 1.46 COMPONENTS python)

    if (Boost_FOUND AND PYTHONLIBS_FOUND)
        list(APPEND SPCHCNTRL_LIB_INCLUDE_DIRS ${Boost_INCLUDE_DIRS} ${PYTHON_INCLUDE_DIRS})
        list(APPEND SPCHCNTRL_LIB_LIBRARIES ${Boost_LIBRARIES} ${PYTHON_LIBRARIES})
        list(APPEND SPCHCNTRL_LIB_COMPILE_DEFINITIONS "PYTHON_BINDINGS")
    endif (Boost_FOUND AND PYTHONLIBS_FOUND)
else(WITH_PYTHON_BINDINGS)
    message(STATUS "Python bindings for libspeechcontrol disabled.")
endif(WITH_PYTHON_BINDINGS)

## configures
configure_file("${PROJECT_SOURCE_DIR}/config.hpp.in"
    "${PROJECT_SOURCE_DIR}/config.hpp" @ONLY)

## setting up sources
file(GLOB SPCHCNTRL_LIB_SOURCES "*.cpp")
file(GLOB SPCHCNTRL_LIB_HEADERS "*.hpp")
QT4_WRAP_CPP(SPCHCNTRL_LIB_SOURCES ${SPCHCNTRL_LIB_HEADERS} OPTIONS
    -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED)

include_directories("${SPCHCNTRL_LIB_INCLUDE_DIRS}")

add_library(spchcntrl SHARED ${SPCHCNTRL_LIB_SOURCES})

set_target_properties(spchcntrl PROPERTIES
    COMPILE_FLAGS ${SPCHCNTRL_LIB_COMPILE_FLAGS}
    PROJECT_LABEL "libspchcntrl"
    VERSION ${SPCHCNTRL_LIB_VERSION}
    SOVERSION ${SPCHCNTRL_LIB_VERSION})

target_link_libraries(spchcntrl ${SPCHCNTRL_LIB_LIBRARIES})

install(TARGETS spchcntrl
    EXPORT SpeechControlLibraryDepends
    LIBRARY DESTINATION "${SPCHCNTRL_LIB_DIR}")

install(EXPORT SpeechControlLibraryDepends
    DESTINATION "${SPCHCNTRL_CMAKE_DIR}"
    COMPONENT "dev")

install(FILES ${SPCHCNTRL_LIB_HEADERS}
    DESTINATION "${SPCHCNTRL_LIB_INCLUDE_DIR}"
    COMPONENT "dev")
